using System;
using System.Collections.Generic;
using System.Linq;
using System.Net;
using System.Threading;
using System.Threading.Tasks;

namespace MvcBookShop.PrimaveraWebServices
{    public class TokenRequesterThread
    {
        public static void DoWork()
        {
            while (true)
            {
                requestSecondToken();
                requestFirstToken();
                Thread.Sleep(6000);
                //test calls here
                //WebServicesManager.Instance.WS01_CreateCustomer("{\n    \"Cliente\": \"TIAGO13\",\n    \"Nome\": \"Tiago Santos\",\n    \"Morada\": \"Rua Eng. Farinas de Almeida, 313, 4º esq\",\n    \"CodigoPostal\": \"4510-260\",\n    \"Telefone\": \"961843943\",\n    \"NumContribuinte\": \"64287048860\",\n    \"Pais\": \"PT\",\n    \"Moeda\": \"EUR\"\n}");
                //WebServicesManager.Instance.WS02_GetCustomerInformation("TIAGO");
                //WebServicesManager.Instance.WS03_UpdateCustomerAttributes("{\r\n    \"CodigoTabLog\": \"Cliente\",\r\n    \"ChaveLog\": \"Cliente\",\r\n    \"EstadoBE\": \"\",\r\n    \"Cliente\": \"TIAGO\",\r\n    \"Nome\": \"Tiago Santos\",\r\n    \"Descricao\": \"\",\r\n    \"Morada\": \"Rua Eng. Farinas de Almeida, 313, 4\u00BA esq\",\r\n    \"Morada2\": \"\",\r\n    \"Localidade\": \"\",\r\n    \"CodigoPostal\": \"4510-260\",\r\n    \"LocalidadeCodigoPostal\": \"\",\r\n    \"Telefone\": \"961843943\",\r\n    \"Telefone2\": \"\",\r\n    \"Fax\": \"\",\r\n    \"EnderecoWeb\": \"\",\r\n    \"Distrito\": \"\",\r\n    \"GestaoDiasPag\": false,\r\n    \"DiaPagamento1\": 0,\r\n    \"DiaPagamento2\": 0,\r\n    \"DiaPagamento3\": 0,\r\n    \"NumDiasRetrocesso\": 0,\r\n    \"DiaInicialPerNaoPag1\": \"\",\r\n    \"DiaFinalPerNaoPag1\": \"\",\r\n    \"DiaInicialPerNaoPag2\": \"\",\r\n    \"DiaFinalPerNaoPag2\": \"\",\r\n    \"DebitoContaCorrente\": 0,\r\n    \"DebitoVendasNaoConvertidas\": 0,\r\n    \"DebitoEncomendasPendentes\": 0,\r\n    \"TipoCredito\": \"\",\r\n    \"LimiteCredIdade\": false,\r\n    \"LimiteCredValor\": false,\r\n    \"LimiteIdadeSaldo\": 0,\r\n    \"LimiteValorSaldo\": 0,\r\n    \"Limitecredito\": 0,\r\n    \"Desconto\": 0,\r\n    \"LinhaPrecos\": \"0\",\r\n    \"Observacoes\": \"\",\r\n    \"NumContribuinte\": \"64287048860\",\r\n    \"Pais\": \"PT\",\r\n    \"TipoMercado\": \"0\",\r\n    \"ExcluirAvisosVencimento\": false,\r\n    \"ModoPag\": \"\",\r\n    \"ModoRec\": \"\",\r\n    \"CondPag\": \"\",\r\n    \"Moeda\": \"EUR\",\r\n    \"ModoExp\": \"\",\r\n    \"Vendedor\": \"\",\r\n    \"Zona\": \"\",\r\n    \"NumViasDoc\": 0,\r\n    \"ExcluirRecapitulativos\": false,\r\n    \"DataCriacao\": \"1899-12-30T00:00:00\",\r\n    \"RubricaPagamentos\": \"\",\r\n    \"RubricaRecebimentos\": \"\",\r\n    \"TipoTerceiro\": \"\",\r\n    \"SegmentoTerceiro\": \"\",\r\n    \"RegimeIvaReembolsos\": 0,\r\n    \"Factoring\": false,\r\n    \"Inactivo\": false,\r\n    \"ProcessaIntrastat\": false,\r\n    \"IntrastatPorto\": \"\",\r\n    \"SuporteAvisosVencimento\": \"\",\r\n    \"DataUltimaActualizacao\": \"2018-12-01T20:43:16\",\r\n    \"DescricaoComercial\": \"\",\r\n    \"Caracteristicas\": \"\",\r\n    \"Idioma\": \"\",\r\n    \"UtilizaIdioma\": false,\r\n    \"EfectuaRetencao\": false,\r\n    \"EfectuaOutrasRetencoes\": false,\r\n    \"SujeitoRecargo\": false,\r\n    \"ExcluirAlertasCob\": false,\r\n    \"AlertaValorSaldoCob\": false,\r\n    \"ValorSaldoCob\": 0,\r\n    \"AlertaIdadeSaldoCob\": false,\r\n    \"IdadeSaldoCob\": 0,\r\n    \"IdContactoCob\": \"\",\r\n    \"CalendarioCob\": \"\",\r\n    \"IdGDOC\": \"\",\r\n    \"LocalOperacao\": \"\",\r\n    \"DebitoLetrasNovas\": false,\r\n    \"DebitoLetrasReformadas\": false,\r\n    \"CondDebitoLetrasParticular\": false,\r\n    \"JuroLetras\": 0,\r\n    \"JuroLetrasPostecipado\": false,\r\n    \"ComissaoLetras\": 0,\r\n    \"ComissaoLetrasPercent\": false,\r\n    \"PortesLetras\": 0,\r\n    \"CondDebitoLetrasReformadasParticular\": false,\r\n    \"JuroLetrasReformadas\": 0,\r\n    \"JuroLetrasReformadasPostecipado\": false,\r\n    \"ComissaoLetrasReformadas\": 0,\r\n    \"ComissaoLetrasReformadasPercent\": false,\r\n    \"PortesLetrasReformadas\": 0,\r\n    \"PessoaSingular\": false,\r\n    \"Toc\": 0,\r\n    \"FuncionarioResp\": \"\",\r\n    \"FuncionarioTOC\": \"\",\r\n    \"Delegacao\": \"\",\r\n    \"CentroOperacional\": \"\",\r\n    \"Situacao\": \"\",\r\n    \"Equipa\": \"\",\r\n    \"CodPriempre\": \"\",\r\n    \"NomeFiscal\": \"Tiago Santos\",\r\n    \"B2BTrataTrans\": false,\r\n    \"B2BUtilArtigosParceiro\": false,\r\n    \"B2BEnvioNaGravacao\": false,\r\n    \"B2BEnderecoMail\": \"\",\r\n    \"B2BCertificado\": \"\",\r\n    \"IdB2BFormato\": \"\",\r\n    \"B2BEnderecoEnvio\": \"\",\r\n    \"B2BDocDownload\": false,\r\n    \"B2BArtigosParceiro\": \"\",\r\n    \"B2BUtilUnidadesParceiro\": false,\r\n    \"B2BUnidadesParceiro\": \"\",\r\n    \"B2BIgnoraEnvioParceiro\": false,\r\n    \"B2BEnvioParceiro\": \"\",\r\n    \"B2BIgnoraTransaccoes\": false,\r\n    \"B2BTransaccoes\": \"\",\r\n    \"CodigoGLN\": \"\",\r\n    \"EncargosBanco\": false,\r\n    \"EncargosBancos\": [],\r\n    \"CodigoIEC\": \"\",\r\n    \"CodigoIsencaoIEC\": \"\",\r\n    \"IsentoIEC\": false,\r\n    \"CambioADataDoc\": false,\r\n    \"EmModoEdicao\": true,\r\n    \"CamposUtil\": [\r\n        {\r\n            \"Conteudo\": \"ValorValor\",\r\n            \"Nome\": \"CDU_CampoVar1\",\r\n            \"Valor\": null,\r\n            \"Objecto\": null,\r\n            \"Tipo\": 1,\r\n            \"ChaveLog\": \"Nome\",\r\n            \"EstadoBE\": \"\",\r\n            \"TipoSimplificado\": 1\r\n        },\r\n        {\r\n            \"Conteudo\": \"ValorValor\",\r\n            \"Nome\": \"CDU_CampoVar2\",\r\n            \"Valor\": null,\r\n            \"Objecto\": null,\r\n            \"Tipo\": 1,\r\n            \"ChaveLog\": \"Nome\",\r\n            \"EstadoBE\": \"\",\r\n            \"TipoSimplificado\": 1\r\n        },\r\n        {\r\n            \"Conteudo\": \"ValorValor\",\r\n            \"Nome\": \"CDU_CampoVar3\",\r\n            \"Valor\": null,\r\n            \"Objecto\": null,\r\n            \"Tipo\": 1,\r\n            \"ChaveLog\": \"Nome\",\r\n            \"EstadoBE\": \"\",\r\n            \"TipoSimplificado\": 1\r\n        },\r\n        {\r\n            \"Conteudo\": \"ValorValoremailxyz@gmail.com\",\r\n            \"Nome\": \"CDU_email\",\r\n            \"Valor\": \"emailxyz@gmail.com\",\r\n            \"Objecto\": null,\r\n            \"Tipo\": 1,\r\n            \"ChaveLog\": \"Nome\",\r\n            \"EstadoBE\": \"\",\r\n            \"TipoSimplificado\": 1\r\n        },\r\n        {\r\n            \"Conteudo\": \"ValorValor03AC674216F3E15C761EE1A5E255F067953623C8B388B4459E13F978D7C846F4\",\r\n            \"Nome\": \"CDU_password_hash\",\r\n            \"Valor\": \"03AC674216F3E15C761EE1A5E255F067953623C8B388B4459E13F978D7C846F4\",\r\n            \"Objecto\": null,\r\n            \"Tipo\": 1,\r\n            \"ChaveLog\": \"Nome\",\r\n            \"EstadoBE\": \"\",\r\n            \"TipoSimplificado\": 1\r\n        }\r\n    ],\r\n    \"Conteudo\": \"ClienteTIAGONomeTiago SantosNomeFiscalTiago SantosDescricaoMoradaRua Eng. Farinas de Almeida, 313, 4\u00BA esqMorada2LocalidadeCodigoPostal4510-260LocalidadeCodigoPostalTelefone961843943Telefone2FaxEnderecoWebDistritoLinhaPrecos0UtilizaIdiomaFalseIdiomaEfectuaRetencaoFalseEfectuaOutrasRetencoesFalseSujeitoRecargoFalseLimiteCredValorFalseLimiteCredIdadeFalseLimiteIdadeSaldo0LimiteValorSaldo0LimiteCredito0ExcluirAlertasCobFalseAlertaValorSaldoCobFalseValorSaldoCob0AlertaIdadeSaldoCobFalseIdadeSaldoCob0CalendarioCobIdContactoCobTipoCreditoIdGDOCObservacoesNumContribuinte64287048860ContribuinteNaoResidentePaisPTTipoMercado0ModoPagModoRecCondPagMoedaEURModoExpVendedorZonaRubricaPagamentosRubricaRecebimentosTipoTerceiroIntrastatPortoSuporteAvisosVencimentoSegmentoTerceiroDataCriacao30-12-1899 00:00:00DataUltimaActualizacao01-12-2018 20:43:16Desconto0DebitoContaCorrente0ExcluirAvisosVencimentoFalseNumViasDoc0ExcluirRecapitulativosFalseInactivoFalseVendasNaoConvertidas0DebitoEncomendasPendentes0ProcessaIntrastatFalseLocalOperacaoToc0FuncionarioRespFuncionarioTOCDelegacaoCentroOperacionalSituacaoEquipaCodPRIEMPREIdB2BFormatoB2BEnderecoMailB2BEnderecoEnvioB2BEnvioNaGravacaoFalseB2BTrataTransFalseB2BCertificadoB2BDocDownloadFalseB2BUtilArtigosParceiroFalseB2BArtigosParceiroB2BUtilUnidadesParceiroFalseB2BUnidadesParceiroB2BIgnoraEnvioParceiroFalseB2BEnvioParceiroB2BIgnoraTransaccoesFalseB2BTransaccoesCodigoIECCodigoIsencaoIECIsentoIECFalseCodigoGLNGestaoDiasPagFalseDiaPagamento10DiaPagamento20DiaPagamento30NumDiasRetrocesso0DiaInicialPerNaoPag1DataFinalPerNaoPag1DiaInicialPerNaoPag2DiaFinalPerNaoPag2EncargosBancoFalseRegimeIvaReembolsos0FactoringFalseCambioADataDocFalseFacturacaoAgrupadaBillingFalseActividadeEmpresarialFalseAutoFacturacaoFalseTrataIvaCaixaFalseeGAR_CodigoAPAeGAR_IsentaFalseeGAR_NumPGLeGAR_TipoProdutorTipoRemetenteTipoRemetenteEntidadeParceira\",\r\n    \"ContribuinteNaoResidente\": \"\",\r\n    \"IntegraCessaoFactoring\": false,\r\n    \"ActividadeEmpresarial\": false,\r\n    \"eGAR_Isenta\": false,\r\n    \"eGAR_CodigoAPA\": \"\",\r\n    \"eGAR_NumPGL\": \"\",\r\n    \"eGAR_TipoProdutor\": \"\",\r\n    \"TipoRemetente\": \"\",\r\n    \"CodigoLocal\": \"\",\r\n    \"Locked\": false,\r\n    \"AutoFacturacao\": false,\r\n    \"TrataIvaCaixa\": false,\r\n    \"FacturacaoAgrupadaBilling\": false,\r\n    \"ShareBI\": {\r\n        \"Conteudo\": \"VersaoCloud0ActualizacaoCloudActualizacaoERP\",\r\n        \"EstadoBE\": \"\",\r\n        \"ChaveLog\": \"\",\r\n        \"CodigoTabLog\": \"\",\r\n        \"PropExcluirLog\": \"\",\r\n        \"VersaoCloud\": 0,\r\n        \"ActualizacaoCloud\": \"\",\r\n        \"ActualizacaoERP\": \"\",\r\n        \"AbvtApl\": \"BAS\"\r\n    },\r\n    \"EntidadeParceira\": \"\",\r\n    \"AbvtApl\": \"BAS\"\r\n}");
                WebServicesManager.Instance.WS04_GetBookInformation("B0001");
                Thread.Sleep(1000 * 1000);
            }
        }

        private static void requestFirstToken()
        {
            string res = WebServicesManager.Instance.WS_TokenWithoutCompany();
            WebServicesManager.Instance.FirstToken = res;
        }

        private static void requestSecondToken()
        {
            string res = WebServicesManager.Instance.WS_TokenRequest();
            WebServicesManager.Instance.SecondToken = res;
        }
    }
}
